(function($){$(function(){$("#phupdate textarea").focus();$(".textarea-wrapper textarea").click(function(){$(this).height("4.6em").parent().siblings(".tip, .act").fadeIn(50);$(".textarea-wrapper").addClass("textarea-wrapper-active");$(".textarea-wrapper textarea").css("borderColor","#7DC6DD");}).focus(function(){if($(this).val()){$(this).height("4.6em").parent().siblings(".tip, .act").fadeIn();$(".textarea-wrapper").addClass("textarea-wrapper-active");$(".textarea-wrapper textarea").css("borderColor","#7DC6DD");}}).keydown(function(){if($(this).val()){$(this).height("4.6em").parent().siblings(".tip, .act").fadeIn();$(".textarea-wrapper").addClass("textarea-wrapper-active");$(".textarea-wrapper textarea").css("borderColor","#7DC6DD");}});var _2=$("#message").attr("action");function setFilename(fn){$("#upload-filename").text(fn);$("#message").attr("action","/home/upload").attr("enctype","multipart/form-data");$("#phupdate input[name=action]").val("photo.upload");$("#phupdate textarea").attr("name","desc");}$("#upload-button").click(function(_4){_4.preventDefault();_4.stopPropagation();});$("#upload-file").bind("change",function(){var fn=$(this).val().replace(/[^\/\\]*(\/|\\)/g,"");if(!/jpe?g$|png$|gif$/i.test(fn)){alert("\u6587\u4ef6\u683c\u5f0f\u9519\u8bef\uff0c\u4ec5\u652f\u6301jpg\u3001jpeg\u3001gif\u3001png\u683c\u5f0f\u7684\u56fe\u7247\u6587\u4ef6\u3002");return;}setFilename(fn);$("#upload-filename, #ul_close").show();$("#upload-button").css("backgroundPosition","-40px 0");});$("#phupdate textarea").dragAndDropFiles({data:function(_6,_7){setFilename(_7.name);$("#upload-base64").val(_6);$("#upload-wrapper").slideDown();},hoverClass:"upload-drag-hover"});$("#upload-wrapper").on("click","#ul_close",function(){$("#upload-filename").text("");$("#message").attr("enctype","application/x-www-form-urlencoded").attr("action",_2);$("#phupdate input[name=action]").val("msg.post");$("#phupdate textarea").attr("name","content");$("#upload-base64").val("");$("#upload-button").show();$("#upload-filename, #ul_close").hide();$("#upload-button").css("backgroundPosition","0 0");$("#upload-file").val("");});});})(jQuery);