(function(jq){var _2=jq({});jq.ajaxQueue=function(_3){var _4,_5=jq.Deferred(),_6=_5.promise();_2.queue(doRequest);_6.abort=function(_7){if(_4){return _4.abort(_7);}var _8=_2.queue(),_9=jq.inArray(doRequest,_8);if(_9>-1){_8.splice(_9,1);}_5.rejectWith(_3.context||_3,[_6,_7,""]);return _6;};function doRequest(_a){_4=jq.ajax(_3).then(_a,_a).done(_5.resolve).fail(_5.reject);}return _6;};})(jQuery);function getRecmduserElement(_b){var _c="<li class=\"rec_usr\">                <input type=\"hidden\" name=\"token\" value=\""+_b.token+"\" />                 <a class=\"rec_usr_img\" title=\""+_b.realname+"\" href=\"/"+_b.loginname+"\">                     <img alt=\""+_b.loginname+"\" src=\""+_b.profile_image_url+"\"> </a>                 <a class=\"dismiss\" title=\"\u53d6\u6d88\" href=\"#\"><span>\u53d6\u6d88</span></a>                 <div class=\"rec_user_info\"> <ul>                     <li>                     <a class=\"rec_usr_realname\" href=\"/"+_b.loginname+"\">"+_b.realname+"</a>                     <a class=\"accept_action\" href=\"#\">\u5173\u6ce8</a> </li>                     <li class=\"rec_usr_lastmsg\">"+_b.lastmsg+"</li> </ul> </div></li>";return jQuery(_c);}function recmdUserOption(lk,_e,_f){lk.preventDefault();var _10=jQuery(_e).attr("href");var _11=jQuery(_e).parents(".rec_usr");var _12=jQuery(".rec_usr_img").map(function(){return jQuery(this).attr("href");}).get().join("/");var _13=_11.find(".rec_usr_img img").attr("alt");var _14=_11.find("input").attr("value");_11.remove();jQuery.ajaxQueue({type:"POST",data:{"token":_14,"names":_12+"/","action":_f,"friend":_13},url:"/recmduser",async:false,success:function(_15){jQuery.each(_15.new_usr,function(_16,_17){var ele=getRecmduserElement(_17);ele.find(".accept_action").click(function(lk){recmdUserOption(lk,this,"recmduser.accept");});ele.find(".dismiss").click(function(lk){recmdUserOption(lk,this,"recmduser.ignore");});ele.appendTo(jQuery("#user_rec #rec_users"));});},dataType:"json"});}jQuery(document).ready(function(){jQuery.getJSON("/recmduser",function(_1b){if(_1b.length<1){return;}jQuery("#user_rec").show();jQuery.each(_1b,function(_1c,_1d){var ele=getRecmduserElement(_1d);ele.find(".accept_action").click(function(lk){recmdUserOption(lk,this,"recmduser.accept");});ele.find(".dismiss").click(function(lk){recmdUserOption(lk,this,"recmduser.ignore");});ele.appendTo(jQuery("#user_rec #rec_users"));});});});